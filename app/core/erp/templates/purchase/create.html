{% extends 'purchase/base_purchase.html' %}
{% load static %}

{% block head_list %}
    <link href="{% static 'lib/select2-4.0.13/css/select2.min.css' %}" rel="stylesheet">
    <script src="{% static 'lib/select2-4.0.13/js/select2.min.js' %}"></script>

    <script src="{% static 'js/functions.js' %}"></script>

<script>
$(function () {

    // Select2 proveedor
    $('#id_provider').select2({
        theme: 'bootstrap4',
        width: '100%'
    });

    $('form').on('submit', function (e) {
        e.preventDefault();

        let formData = new FormData(this);

        submit_with_ajax(
            window.location.pathname,
            formData,
            function (response) {

                console.log("Respuesta del servidor:", response);

                // ðŸŸ¦ VALIDACIÃ“N CORRECTA (NO DA FALSOS ERRORES)
                if (!response.error || response.error === "") {
                    window.location.href = response.redirect_url;
                } else {
                    message_error(response.error);
                }
            }
        );
    });

});
</script>


{% endblock %}


{% block content %}
<form method="post">
<div class="card card-primary">
    <div class="card-header">
        <h3 class="card-title">
            <i class="fas fa-truck"></i> Crear nueva compra
        </h3>
    </div>

    <div class="card-body">
        {% csrf_token %}

        <div class="form-group">
            <label>Proveedor</label>
            {{ form.provider }}
        </div>

        <div class="form-group">
            <label>Fecha</label>
            {{ form.date }}
        </div>

        <div class="form-group">
            <label>Observaciones</label>
            {{ form.observations }}
        </div>

    </div>

    <div class="card-footer text-right">
        <button type="submit" class="btn btn-primary">
            <i class="fas fa-arrow-right"></i> Continuar
        </button>
    </div>
</div>
</form>
{% endblock %}
